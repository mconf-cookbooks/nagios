# Command definitions
#
# Autogenerated by Chef.

# Host checks
define command {
  command_name    check-host-alive
  command_line    $USER1$/check_ping -H $HOSTADDRESS$ -w 2000,80% -c 3000,100% -p 1 -4
}

# Service checks
define command {
  command_name    check_nagios
  command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_nagios -t 20
}

# nrpe remote host checks
define command {
  command_name    check_nrpe_alive
  command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -t 20
}

define command {
  command_name    check_nrpe
  command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c $ARG1$ -t 20
}

# Notification
define command {
  command_name    host-notify-by-email
  command_line    /usr/bin/printf "%b" "Notification Type: $NOTIFICATIONTYPE$\nHost: $HOSTNAME$\nState: $HOSTSTATE$\nAddress: $HOSTADDRESS$\nInfo: $HOSTOUTPUT$\n\nDate/Time: $LONGDATETIME$\n" | <%=node['nagios']['server']['mail_command']%> -s "$NOTIFICATIONTYPE$ - $HOSTALIAS$ is $HOSTSTATE$" $CONTACTEMAIL$ -- -r "<%=node['nagios']['notification_sender_address']%>" -F "<%=node['nagios']['notification_sender_name']%>"
}

define command {
  command_name    host-notify-by-sms-email
  command_line    /usr/bin/printf "%b" "$HOSTALIAS$ $NOTIFICATIONTYPE$ $HOSTSTATE$\n\n$HOSTOUTPUT$" | <%=node['nagios']['server']['mail_command']%> -s "$HOSTALIAS$ $HOSTSTATE$!" $CONTACTPAGER$
}

# 'notify-by-email' command definition
define command {
  command_name    service-notify-by-email
  command_line    /usr/bin/printf "%b" "Notification Type: $NOTIFICATIONTYPE$\n\nService: $SERVICEDESC$\nHost: $HOSTALIAS$\nAddress: $HOSTADDRESS$\nState: $SERVICESTATE$\n\nDate/Time: $LONGDATETIME$\n\nAdditional Info:\n\n$SERVICEOUTPUT$\n" | <%=node['nagios']['server']['mail_command']%> -s "$NOTIFICATIONTYPE$ - $SERVICEDESC$ on $HOSTALIAS$ is $SERVICESTATE$" $CONTACTEMAIL$ -- -r "<%=node['nagios']['notification_sender_address']%>" -F "<%=node['nagios']['notification_sender_name']%>"
}

# Commands added through nagios_commands data bags
<% @commands.each do |command| -%>
define command {
  command_name    <%= command['id'] %>
  command_line    <%= command['command_line'] %>
}
<% end -%>

# Commands added through nagios_services data bags
<% @services.each do |service| -%>
<% unless service['use_existing_command'] -%>
define command {
  command_name    check_<%= service['id'] %>
  command_line    <%= service ['command_line'] %>
}
<% end -%>
<% end -%>

<% if !@eventhandlers.empty? -%>
# Event Handlers added through nagios_eventhandlers data bags
<% @eventhandlers.each do |eventhandlers| -%>
define command {
  command_name    <%= eventhandlers['id'] %>
  command_line    <%= eventhandlers['command_line'] %>
}
<% end -%>
<% end -%>
